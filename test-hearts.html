<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Тест сердечек | Easy Body Food</title>
    <link rel="icon" type="image/png" href="assets/img/logo.png">
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;500;600;700&family=Rubik:wght@900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="assets/css/static/header.css">
    <link rel="stylesheet" href="assets/css/static/footer.css">
    <link rel="stylesheet" href="assets/css/main/alt-theme.css">
    <link rel="stylesheet" href="assets/css/main/main-theme.css">
    <style>
        .test-section {
            padding: 40px 20px;
            max-width: 1200px;
            margin: 0 auto;
        }
        .test-cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }
        .test-controls {
            background: #f5f5f5;
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
        }
        .test-controls button {
            background: #4CAF50;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            margin: 5px;
            cursor: pointer;
        }
        .test-controls button:hover {
            background: #388e3c;
        }
        .favorites-list {
            background: #e8f5e8;
            padding: 15px;
            border-radius: 5px;
            margin: 10px 0;
        }
    </style>
</head>
<body>
    <div id="header"></div>
    
    <main class="main-content">
        <section class="test-section">
            <h1>Тест системы избранных блюд</h1>
            
            <div class="test-controls">
                <h3>Управление</h3>
                <button onclick="showFavorites()">Показать избранное</button>
                <button onclick="clearFavorites()">Очистить избранное</button>
                <button onclick="refreshHearts()">Обновить сердечки</button>
                <div class="favorites-list" id="favoritesList">
                    <strong>Избранные блюда:</strong> <span id="favoritesCount">0</span>
                </div>
            </div>

            <h2>Тестовые карточки (с реальными ID из dishes.json)</h2>
            <div class="test-cards" id="testCards">
                <!-- Карточки будут загружены динамически из dishes.json -->
            </div>
        </section>
    </main>

    <div id="footer"></div>
    
    <script src="assets/js/layout.js"></script>
    <script src="assets/js/hearts.js"></script>
    <script>
        // Функции для тестирования
        function showFavorites() {
            if (window.heartsManager) {
                const favorites = window.heartsManager.getFavoriteDishes();
                const count = favorites.length;
                document.getElementById('favoritesCount').textContent = count;
                
                // Показываем также полное состояние из localStorage
                const heartsState = JSON.parse(localStorage.getItem('heartsState') || '{}');
                
                const list = document.getElementById('favoritesList');
                if (count > 0) {
                    list.innerHTML = `
                        <strong>Избранные блюда (${count}):</strong><br>
                        ${favorites.join(', ')}<br><br>
                        <strong>Полное состояние heartsState:</strong><br>
                        ${JSON.stringify(heartsState, null, 2)}
                    `;
                } else {
                    list.innerHTML = `
                        <strong>Избранные блюда:</strong> нет избранных блюд<br><br>
                        <strong>Полное состояние heartsState:</strong><br>
                        ${JSON.stringify(heartsState, null, 2)}
                    `;
                }
                
                console.log('Избранные блюда:', favorites);
                console.log('Полное состояние heartsState:', heartsState);
            }
        }

        function clearFavorites() {
            if (window.heartsManager) {
                window.heartsManager.clearFavorites();
                showFavorites();
                
                // Убираем активные классы со всех сердечек
                document.querySelectorAll('.gallery-heart, .gallery-heart-alt, .menu-card-heart, .menu-card-heart-alt').forEach(heart => {
                    heart.classList.remove('active');
                });
                
                console.log('Избранное очищено');
            }
        }

        function refreshHearts() {
            if (window.heartsManager) {
                window.heartsManager.refresh();
                console.log('Сердечки обновлены');
            }
        }

        // Загружаем реальные блюда из dishes.json
        function loadTestCards() {
            fetch('assets/data/dishes.json')
                .then(response => response.json())
                .then(dishes => {
                    // Выбираем несколько случайных блюд для тестирования
                    const shuffled = dishes.sort(() => 0.5 - Math.random());
                    const selected = shuffled.slice(0, 4);
                    
                    const testCards = document.getElementById('testCards');
                    testCards.innerHTML = selected.map((dish, index) => {
                        if (index === 0) {
                            // Галерея карточка
                            return `
                                <div class="gallery-card" data-dish-id="${dish.id}">
                                    <img src="${dish.img || 'assets/img/food1.jpg'}" alt="${dish.title}" class="gallery-img">
                                    <div class="gallery-card-icons">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="gallery-heart icon-heart">
                                            <path d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41 0.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"/>
                                        </svg>
                                    </div>
                                    <div class="gallery-card-info">
                                        <div class="gallery-card-title">${dish.title}</div>
                                        <div class="gallery-card-desc">ID: ${dish.id} | Тип: ${dish.type}</div>
                                    </div>
                                </div>
                            `;
                        } else if (index === 1) {
                            // Меню карточка
                            return `
                                <div class="menu-card" data-dish-id="${dish.id}">
                                    <div class="menu-card-img-wrap">
                                        <img src="${dish.img || 'assets/img/food2.jpg'}" alt="${dish.title}" class="menu-card-img">
                                        <div class="gallery-card-icons">
                                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="gallery-heart icon-heart">
                                                <path d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41 0.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"/>
                                            </svg>
                                        </div>
                                        <span class="menu-card-plus">+</span>
                                    </div>
                                    <div class="menu-card-content">
                                        <div class="menu-card-title">${dish.title}</div>
                                        <div class="menu-card-macros">Б: ${dish.p} г, Ж: ${dish.f} г, В: ${dish.c} г</div>
                                        <div class="menu-card-desc">ID: ${dish.id} | Тип: ${dish.type}</div>
                                    </div>
                                </div>
                            `;
                        } else if (index === 2) {
                            // Альтернативная меню карточка
                            return `
                                <div class="menu-card-alt" data-dish-id="${dish.id}">
                                    <div class="menu-card-img-wrap-alt">
                                        <img src="${dish.img || 'assets/img/food3.jpg'}" alt="${dish.title}" class="menu-card-img">
                                        <div class="gallery-card-icons-alt">
                                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="gallery-heart-alt icon-heart">
                                                <path d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41 0.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"/>
                                            </svg>
                                        </div>
                                        <span class="menu-card-plus-alt">+</span>
                                    </div>
                                    <div class="menu-card-content-alt">
                                        <div class="menu-card-title-alt">${dish.title}</div>
                                        <div class="menu-card-macros-alt">Б: ${dish.p} г, Ж: ${dish.f} г, В: ${dish.c} г</div>
                                        <div class="menu-card-desc-alt">ID: ${dish.id} | Тип: ${dish.type}</div>
                                    </div>
                                </div>
                            `;
                        } else {
                            // Еще одна галерея карточка
                            return `
                                <div class="gallery-card" data-dish-id="${dish.id}">
                                    <img src="${dish.img || 'assets/img/food4.jpg'}" alt="${dish.title}" class="gallery-img">
                                    <div class="gallery-card-icons">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="gallery-heart icon-heart">
                                            <path d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41 0.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"/>
                                        </svg>
                                    </div>
                                    <div class="gallery-card-info">
                                        <div class="gallery-card-title">${dish.title}</div>
                                        <div class="gallery-card-desc">ID: ${dish.id} | Тип: ${dish.type}</div>
                                    </div>
                                </div>
                            `;
                        }
                    }).join('');
                    
                    // Обновляем обработчики сердечек
                    if (window.heartsManager) {
                        window.heartsManager.refresh();
                    }
                })
                .catch(error => {
                    console.error('Ошибка загрузки блюд:', error);
                    document.getElementById('testCards').innerHTML = '<p>Ошибка загрузки блюд</p>';
                });
        }

        // Показываем избранное при загрузке
        document.addEventListener('DOMContentLoaded', () => {
            loadTestCards();
            setTimeout(showFavorites, 500);
        });
    </script>
</body>
</html> 